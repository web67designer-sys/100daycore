let userData = {
name:"",
email:"",
age:null,
goal:"",
gender:"",
level:1,
xp:0,
xpNeeded:100,
coins:0,
streak:0,
completedDays:[],
todayCompleted:false,
currentTaskIndex:0,
inventory:[],
isPremium:false
};

const goalTasks = {
  weightLoss: [
    { task: "Morning 20-min walk", points: 50 },
    { task: "Drink 3L water", points: 50 },
    { task: "No sugar today", points: 50 },
    { task: "30-min cardio", points: 50 },
    { task: "Eat salad with lunch", points: 50 },
    { task: "10k steps", points: 50 },
    { task: "No junk food", points: 50 },
    { task: "Intermittent fasting 16:8", points: 50 },
    { task: "Green tea instead of soda", points: 50 },
    { task: "Home HIIT workout", points: 50 },
    { task: "Track calories", points: 50 },
    { task: "Avoid late night snacks", points: 50 },
    { task: "Stretch 15 mins", points: 50 },
    { task: "Eat high protein meal", points: 50 },
    { task: "Replace rice with veggies", points: 50 },
    { task: "Cycling 30 mins", points: 50 },
    { task: "Swimming session", points: 50 },
    { task: "Leg day workout", points: 50 },
    { task: "Core workout", points: 50 },
    { task: "Reduce carbs today", points: 50 },
    { task: "No fried food", points: 50 },
    { task: "Meal prep healthy food", points: 50 },
    { task: "Morning lemon water", points: 50 },
    { task: "Jogging 25 mins", points: 50 },
    { task: "Jump rope 10 mins", points: 50 },
    { task: "Burpees 3 sets", points: 50 },
    { task: "Wall sits challenge", points: 50 },
    { task: "Plank 3 mins total", points: 50 },
    { task: "Pushups 30 reps", points: 50 },
    { task: "Squats 50 reps", points: 50 },
    { task: "Healthy breakfast", points: 50 },
    { task: "Avoid processed food", points: 50 },
    { task: "Evening walk", points: 50 },
    { task: "Yoga session", points: 50 },
    { task: "Sleep 8 hours", points: 50 },
    { task: "No soft drinks", points: 50 },
    { task: "Eat fruits today", points: 50 },
    { task: "Protein shake instead dessert", points: 50 },
    { task: "Track weight progress", points: 50 },
    { task: "Reduce portion size", points: 50 },
    { task: "Outdoor activity 1hr", points: 50 },
    { task: "Dance workout", points: 50 },
    { task: "Climb stairs instead lift", points: 50 },
    { task: "Drink detox water", points: 50 },
    { task: "Low calorie dinner", points: 50 },
    { task: "Meal without oil", points: 50 },
    { task: "Healthy snack choice", points: 50 },
    { task: "Consistency check", points: 50 },
    { task: "Track body measurements", points: 50 },
    { task: "Weekly progress review", points: 50 }
  ],

  muscleGain: [
    { task: "Chest workout", points: 50 },
    { task: "Back workout", points: 50 },
    { task: "Shoulder workout", points: 50 },
    { task: "Leg workout", points: 50 },
    { task: "Biceps workout", points: 50 },
    { task: "Triceps workout", points: 50 },
    { task: "Deadlift session", points: 50 },
    { task: "Bench press session", points: 50 },
    { task: "Squat session", points: 50 },
    { task: "Pull-ups 3 sets", points: 50 },
    { task: "Pushups 4 sets", points: 50 },
    { task: "Increase protein intake", points: 50 },
    { task: "Protein shake", points: 50 },
    { task: "Progressive overload", points: 50 },
    { task: "Warm up properly", points: 50 },
    { task: "Stretch after workout", points: 50 },
    { task: "Track reps", points: 50 },
    { task: "Track weight lifted", points: 50 },
    { task: "Calorie surplus day", points: 50 },
    { task: "Eggs in breakfast", points: 50 },
    { task: "Chicken meal", points: 50 },
    { task: "Peanut butter snack", points: 50 },
    { task: "Core strength workout", points: 50 },
    { task: "Upper body session", points: 50 },
    { task: "Lower body session", points: 50 },
    { task: "Rest and recovery day", points: 50 },
    { task: "Foam rolling", points: 50 },
    { task: "Hydration check", points: 50 },
    { task: "Good posture practice", points: 50 },
    { task: "Increase dumbbell weight", points: 50 },
    { task: "Barbell training", points: 50 },
    { task: "Resistance band training", points: 50 },
    { task: "Incline pushups", points: 50 },
    { task: "Chin-ups", points: 50 },
    { task: "Farmer carry", points: 50 },
    { task: "Muscle mind connection focus", points: 50 },
    { task: "Healthy carbs meal", points: 50 },
    { task: "Oats breakfast", points: 50 },
    { task: "Milk intake", points: 50 },
    { task: "Track body weight", points: 50 },
    { task: "Check muscle progress pics", points: 50 },
    { task: "Heavy lifting day", points: 50 },
    { task: "Light recovery workout", points: 50 },
    { task: "Abs workout", points: 50 },
    { task: "Glutes workout", points: 50 },
    { task: "Hamstring workout", points: 50 },
    { task: "Calf raises", points: 50 },
    { task: "Forearm workout", points: 50 },
    { task: "Sleep 8 hours", points: 50 },
    { task: "Weekly strength test", points: 50 }
  ],

  healthyLifestyle: [
    { task: "Wake up early", points: 50 },
    { task: "Meditation 10 mins", points: 50 },
    { task: "Deep breathing", points: 50 },
    { task: "Drink water on wake", points: 50 },
    { task: "Healthy breakfast", points: 50 },
    { task: "Read 20 mins", points: 50 },
    { task: "Journal thoughts", points: 50 },
    { task: "Digital detox 1hr", points: 50 },
    { task: "Call family member", points: 50 },
    { task: "Clean your room", points: 50 },
    { task: "Gratitude list", points: 50 },
    { task: "Nature walk", points: 50 },
    { task: "Limit screen time", points: 50 },
    { task: "Plan next day", points: 50 },
    { task: "Sleep before 11pm", points: 50 },
    { task: "Healthy lunch", points: 50 },
    { task: "Healthy dinner", points: 50 },
    { task: "Positive affirmation", points: 50 },
    { task: "Smile more", points: 50 },
    { task: "Avoid negativity", points: 50 },
    { task: "Stretching routine", points: 50 },
    { task: "Sunlight exposure", points: 50 },
    { task: "Organize workspace", points: 50 },
    { task: "Declutter space", points: 50 },
    { task: "Hydration goal met", points: 50 },
    { task: "Practice kindness", points: 50 },
    { task: "No gossip day", points: 50 },
    { task: "Cook healthy meal", points: 50 },
    { task: "No junk day", points: 50 },
    { task: "Self reflection", points: 50 },
    { task: "Goal review", points: 50 },
    { task: "Weekly reset", points: 50 },
    { task: "Track habits", points: 50 },
    { task: "Morning routine complete", points: 50 },
    { task: "Evening routine complete", points: 50 },
    { task: "Drink herbal tea", points: 50 },
    { task: "Limit caffeine", points: 50 },
    { task: "Avoid sugar", points: 50 },
    { task: "Good posture", points: 50 },
    { task: "Help someone", points: 50 },
    { task: "Practice patience", points: 50 },
    { task: "No complaining day", points: 50 },
    { task: "Focus on self growth", points: 50 },
    { task: "Creative activity", points: 50 },
    { task: "Mindful eating", points: 50 },
    { task: "Deep cleaning task", points: 50 },
    { task: "Personal hygiene care", points: 50 },
    { task: "Mental health check", points: 50 },
    { task: "Weekly reflection", points: 50 },
    { task: "Celebrate small win", points: 50 }
  ],

  productivity: [
    { task: "Wake up 6AM", points: 50 },
    { task: "Make to-do list", points: 50 },
    { task: "Complete hardest task first", points: 50 },
    { task: "Study 1 hour", points: 50 },
    { task: "Read 10 pages", points: 50 },
    { task: "No phone 2 hrs", points: 50 },
    { task: "Finish pending work", points: 50 },
    { task: "Organize files", points: 50 },
    { task: "Plan weekly goals", points: 50 },
    { task: "Focus 45-min session", points: 50 },
    { task: "Learn new skill", points: 50 },
    { task: "Watch educational video", points: 50 },
    { task: "Write 500 words", points: 50 },
    { task: "Code 30 mins", points: 50 },
    { task: "Practice typing speed", points: 50 },
    { task: "Update resume", points: 50 },
    { task: "Research topic", points: 50 },
    { task: "Clean inbox", points: 50 },
    { task: "Review finances", points: 50 },
    { task: "Budget planning", points: 50 },
    { task: "Pomodoro x4", points: 50 },
    { task: "Brainstorm ideas", points: 50 },
    { task: "Skill practice", points: 50 },
    { task: "Online course lesson", points: 50 },
    { task: "Networking message", points: 50 },
    { task: "Public speaking practice", points: 50 },
    { task: "Create project plan", points: 50 },
    { task: "Update portfolio", points: 50 },
    { task: "Morning deep work", points: 50 },
    { task: "Evening review", points: 50 },
    { task: "Limit distractions", points: 50 },
    { task: "Organize schedule", points: 50 },
    { task: "Goal visualization", points: 50 },
    { task: "Skill improvement", points: 50 },
    { task: "Daily reflection", points: 50 },
    { task: "Time tracking", points: 50 },
    { task: "Set deadlines", points: 50 },
    { task: "Finish book chapter", points: 50 },
    { task: "Improve handwriting", points: 50 },
    { task: "Declutter desk", points: 50 },
    { task: "Create habit tracker", points: 50 },
    { task: "Mind mapping", points: 50 },
    { task: "Update calendar", points: 50 },
    { task: "Plan tomorrow", points: 50 },
    { task: "Avoid procrastination", points: 50 },
    { task: "Skill revision", points: 50 },
    { task: "Practice consistency", points: 50 },
    { task: "Read industry news", points: 50 },
    { task: "Track progress", points: 50 },
    { task: "Weekly productivity review", points: 50 }
  ]
};

let leaderboard = [
{name:"Alex",xp:3500,avatar:"ğŸ‘¨",coins:500},
{name:"Sarah",xp:2800,avatar:"ğŸ‘©",coins:400},
{name:"Mike",xp:2200,avatar:"ğŸ‘¨",coins:300},
{name:"Emma",xp:1800,avatar:"ğŸ‘©",coins:200},
{name:"You",xp:0,avatar:"ğŸ˜",coins:0}
];

let storeItems = [
{id:1,name:"Cool Shades",price:100,type:"accessory",icon:"ğŸ•¶ï¸",level:1},
{id:2,name:"Cap",price:150,type:"accessory",icon:"ğŸ§¢",level:1},
{id:3,name:"Crown",price:500,type:"accessory",icon:"ğŸ‘‘",level:5},
{id:4,name:"Gold Frame",price:300,type:"frame",icon:"ğŸ–¼ï¸",level:3},
{id:5,name:"Diamond Frame",price:1000,type:"frame",icon:"ğŸ’",level:10},
{id:6,name:"Fire Aura",price:750,type:"aura",icon:"ğŸ”¥",level:7},
{id:7,name:"Angel Wings",price:800,type:"aura",icon:"ğŸ˜‡",level:8},
{id:8,name:"Cool Hat",price:200,type:"accessory",icon:"ğŸ©",level:2},
{id:9,name:"Headphones",price:250,type:"accessory",icon:"ğŸ§",level:2}
];

const onboardingScreen=document.getElementById('onboarding-screen');
const appContainer=document.getElementById('app-container');
const sidebar=document.getElementById('sidebar');
const burgerMenu=document.querySelector('.burger-menu');
const menuItems=document.querySelectorAll('.menu-item');
const screens=document.querySelectorAll('.screen');

document.addEventListener('DOMContentLoaded',function(){
loadData();
setupEventListeners();
checkOnboarding();
});

function checkOnboarding(){
if(userData.name===""){
onboardingScreen.classList.remove('hidden');
}else{
onboardingScreen.classList.add('hidden');
updateUI();
}
}

function loadData(){
const saved=localStorage.getItem('genZGoalUser');
if(saved){
userData=JSON.parse(saved);
leaderboard[4].xp=userData.xp;
leaderboard[4].coins=userData.coins;
}
}

function saveData(){
localStorage.setItem('genZGoalUser',JSON.stringify(userData));
leaderboard[4].xp=userData.xp;
leaderboard[4].coins=userData.coins;
}

function setupEventListeners(){

if(burgerMenu){
burgerMenu.addEventListener('click',function(){
sidebar.classList.toggle('active');
});
}

menuItems.forEach(function(item){
item.addEventListener('click',function(){
var screen=item.getAttribute('data-screen');
showScreen(screen);
menuItems.forEach(function(i){i.classList.remove('active')});
item.classList.add('active');
sidebar.classList.remove('active');
});
});

if(document.getElementById('onboarding-form'))
document.getElementById('onboarding-form').addEventListener('submit',handleOnboarding);

if(document.getElementById('open-calendar'))
document.getElementById('open-calendar').addEventListener('click',openCalendar);

if(document.getElementById('close-calendar'))
document.getElementById('close-calendar').addEventListener('click',closeCalendar);

if(document.getElementById('complete-day-btn'))
document.getElementById('complete-day-btn').addEventListener('click',completeDay);

if(document.getElementById('ai-ask-btn'))
document.getElementById('ai-ask-btn').addEventListener('click',askAI);

if(document.getElementById('ai-input'))
document.getElementById('ai-input').addEventListener('keypress',function(e){
if(e.key==='Enter')askAI();
});

if(document.getElementById('save-profile-btn'))
document.getElementById('save-profile-btn').addEventListener('click',saveProfile);

if(document.getElementById('crate-box'))
document.getElementById('crate-box').addEventListener('click',openCrate);

if(document.getElementById('monthly-plan-btn'))
document.getElementById('monthly-plan-btn').addEventListener('click',function(){buyPremium('monthly')});

if(document.getElementById('yearly-plan-btn'))
document.getElementById('yearly-plan-btn').addEventListener('click',function(){buyPremium('yearly')});
}

function showScreen(screenName){
screens.forEach(function(screen){screen.classList.remove('active')});
let target=document.getElementById(screenName+'-screen');
if(target) target.classList.add('active');
if(screenName==='leaderboard') updateLeaderboard();
if(screenName==='store') updateStore();
if(screenName==='bitmoji') updateBitmoji();
}

function updateUI(){
document.getElementById('level-display').textContent=userData.level;
document.getElementById('streak-display').textContent=userData.streak;
document.getElementById('coins-amount').textContent=userData.coins;
document.getElementById('xp-current').textContent=userData.xp;
document.getElementById('xp-needed').textContent=userData.xpNeeded;

var xpPercent=(userData.xp/userData.xpNeeded)*100;
document.getElementById('xp-fill').style.width=xpPercent+'%';

var badge=getBadge(userData.level);
document.getElementById('badge-display').textContent=badge.name;
document.getElementById('badge-badge').textContent=badge.name.toUpperCase();

var btn=document.getElementById('complete-day-btn');
if(userData.todayCompleted){
btn.disabled=true;
btn.textContent='âœ“ Completed!';
}
}

function getBadge(level){
if(level>=20){return{name:"Legend",icon:"ğŸ†"}}
if(level>=15){return{name:"Master",icon:"â­"}}
if(level>=10){return{name:"Pro",icon:"ğŸ”¥"}}
if(level>=5){return{name:"Intermediate",icon:"ğŸ’ª"}}
return{name:"Rookie",icon:"ğŸŒ±"}
}

function completeDay(){
var completedTasks=document.querySelectorAll('.task-check.checked');
if(completedTasks.length<3){
alert('Complete at least 3 tasks to complete the day!');
return;
}
var today=new Date().getDate();
if(!userData.completedDays.includes(today)){
userData.completedDays.push(today);
}
userData.xp+=50;
userData.coins+=25;
userData.streak+=1;
userData.todayCompleted=true;

if(userData.xp>=userData.xpNeeded){
userData.level++;
userData.xp=userData.xp-userData.xpNeeded;
userData.xpNeeded=Math.floor(userData.xpNeeded*1.5);
alert('ğŸ‰ Level Up! You are now Level '+userData.level);
}

saveData();
updateUI();
alert('ğŸŠ Day Completed! +50 XP, +25 Coins');
}

function buyPremium(plan){
if(plan==='monthly'){
userData.isPremium=true;
alert('âœ… Premium Activated! Welcome to the club ğŸ¥ˆ');
}else{
userData.isPremium=true;
alert('âœ… Premium Activated! Welcome to VIP ğŸ…');
}
saveData();
updateUI();
}
