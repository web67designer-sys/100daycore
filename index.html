// 100DayCore Pro Script Implementation

class User {
    constructor(name, goal, level = 1, streak = 0, xp = 0, coins = 0) {
        this.name = name;
        this.goal = goal;
        this.level = level;
        this.streak = streak;
        this.xp = xp;
        this.coins = coins;
        this.achievements = new Set();
        this.completedDays = new Set();
    }

    completeDay(dayNumber) {
        if (!this.completedDays.has(dayNumber)) {
            this.completedDays.add(dayNumber);
            this.streak++;
            this.xp += 50;
            this.coins += 100;

            // Level up logic: Every 100 XP = next level
            if (this.xp >= this.level * 100) {
                this.levelUp();
            }

            // Achievements check
            if (this.streak >= 7) this.achievements.add("7 Day Warrior");
            if (this.streak >= 30) this.achievements.add("30 Day Beast");
        }
    }

    levelUp() {
        this.level++;
        console.log(`Level up! ${this.name} reached Level ${this.level}`);
        // Additional level-up rewards or logic can be added here
    }

    getStats() {
        return {
            name: this.name,
            goal: this.goal,
            level: this.level,
            streak: this.streak,
            xp: this.xp,
            coins: this.coins,
            achievements: Array.from(this.achievements),
            completedDays: Array.from(this.completedDays),
        };
    }
}

class Task {
    constructor(description, icon = '', completed = false) {
        this.description = description;
        this.icon = icon;
        this.completed = completed;
    }

    toggleComplete() {
        this.completed = !this.completed;
    }

    display() {
        return `${this.completed ? 'âœ”' : 'âœ–'} ${this.description} ${this.icon}`;
    }
}

class Challenge {
    constructor(day, level) {
        this.day = day;
        this.level = level;
        this.bossChallenge = [
            new Task('Train harder today!', 'ðŸ”¥'),
            new Task('Deadlift 4 sets', 'ðŸ‹ï¸â€â™‚ï¸'),
            new Task('Pull-ups 3x10', 'ðŸ”¥'),
            new Task('Protein-rich meal', 'ðŸ¥š'),
            new Task('Foam roll 10 mins', 'ðŸ§˜â€â™‚ï¸')
        ];
    }

    displayTasks() {
        return this.bossChallenge.map(task => task.display()).join('\n');
    }
}

class Leaderboard {
    constructor() {
        this.users = [];
    }

    addUser(user) {
        this.users.push(user);
    }

    rankByCoins() {
        return this.users.sort((a, b) => b.coins - a.coins);
    }

    displayGlobal() {
        const rankedUsers = this.rankByCoins();
        return rankedUsers.map(user => 
            `${user.name} - Lv ${user.level} - Coins: ${user.coins}`
        ).join('\n');
    }
}

// Simulated app usage:

// Step 1: New User Setup
function startChallenge(name, goal) {
    if (!name || !goal) {
        console.log("Please enter your name and select a goal.");
        return null;
    }
    let user = new User(name, goal, 1, 0, 0, 0);
    console.log(`Welcome ${user.name}, your challenge to: ${user.goal} starts now!`);
    return user;
}

// Step 2: Progressing Through Days and Challenges
function completeDayForUser(user, day) {
    if (!user) return;

    console.log(`Day ${day} - Level ${user.level}`);
    const challenge = new Challenge(day, user.level);
    console.log('Boss Challenge Tasks:');
    console.log(challenge.displayTasks());

    user.completeDay(day);
    console.log('Day completed!');
    console.log(`Current Streak: ${user.streak}`);
    console.log(`XP: ${user.xp}, Coins: ${user.coins}`);

    if(user.achievements.size > 0){
        console.log("Achievements Unlocked:");
        user.achievements.forEach(a => console.log(`- ${a}`));
    }
}

// Step 3: Leaderboard Management
const leaderboard = new Leaderboard();

// Testing the script:

// Creating users
const user1 = startChallenge('Lucas', 'Muscle Gain');
const user2 = new User('Emma', 'Muscle Gain', 5, 6, 500, 1100);
const user3 = new User('Hiro', 'Muscle Gain', 6, 10, 600, 980);
const user4 = new User('Chloe', 'Muscle Gain', 6, 8, 550, 950);

// Simulate day completion for Lucas
completeDayForUser(user1, 7);

// Adding users to leaderboard
leaderboard.addUser(user1);
leaderboard.addUser(user2);
leaderboard.addUser(user3);
leaderboard.addUser(user4);

// Display leaderboard
console.log("\n--- Global Leaderboard ---");
console.log(leaderboard.displayGlobal());

// Exporting classes for possible future UI integration
export { User, Challenge, Leaderboard, Task, startChallenge, completeDayForUser };
